# Gins Blog Project Structure

## Overview
Gins Blog is a high-performance, edge-first blog platform built with Astro, Cloudflare Workers, and Drizzle ORM. It features a "Liquid Glass" aesthetic (glassmorphism), internationalization (i18n), and robust security features.

## Tech Stack
- **Framework**: Astro (SSR mode)
- **Runtime**: Cloudflare Workers / Pages
- **Language**: TypeScript
- **Database**: Cloudflare D1 (SQLite) with Drizzle ORM
- **Styling**: UnoCSS (Atomic CSS)
- **Auth**: Arctic (OAuth 2.0) + Oslo
- **Storage**: Cloudflare R2 (Media) + KV (Cache/Session)

## Directory Structure

### Root Configuration
- `astro.config.mjs`: Astro configuration (Cloudflare adapter, integrations).
- `wrangler.jsonc`: Cloudflare Workers configuration (Bindings: DB, KV, R2, AI).
- `uno.config.ts`: UnoCSS thematic configuration (colors, fonts, shortcuts).
- `drizzle.config.ts`: Drizzle Kit configuration for migrations.
- `package.json`: Dependencies and scripts (includes `setup` script).
- `tsconfig.json`: TypeScript configuration.

### Database (`/db`)
- `db/schema.ts`: Definitive database schema (Users, Sessions, Posts, Comments, etc.).
- `drizzle/`: SQL migration files generated by Drizzle Kit.

### Source Code (`/src`)

#### Pages & Routing (`src/pages`)
- `src/pages/index.astro`: Landing page.
- `src/pages/[lang]/`: Localized routes (e.g., `zh`, `en`).
- `src/pages/api/`: API endpoints (Hono or Astro endpoints).
- `src/pages/posts/`: Blog post rendering.
- `src/pages/login/`: Authentication flows (OAuth callbacks).
- `src/pages/admin/`: Admin dashboard (protected routes).

#### Components (`src/components`)
- `src/components/Head.astro`: Global SEO and meta tags.
- `src/components/Header.astro`: Main navigation bar.
- `src/components/Footer.astro`: Site footer.
- `src/components/FormattedDate.astro`: Date localization helper.
- `src/components/react/`: Interactive islands (Preact/React components).

#### Layouts (`src/layouts`)
- `src/layouts/Layout.astro`: Base HTML structure.
- `src/layouts/BlogPost.astro`: Layout for individual blog posts.

#### Core Logic (`src/lib`)
- `src/lib/auth.ts`: Authentication utilities (Session management).
- `src/lib/db.ts`: Database connection client.
- `src/lib/i18n.ts`: Internationalization dictionaries and helpers.
- `src/lib/utils.ts`: General utility functions.
- `src/lib/cloudflare.ts`: Cloudflare-specific helpers (KV, R2).

### Scripts (`/scripts`)
- `scripts/setup.js`: Automated setup script for Cloudflare resources.

## Key Conventions
1. **Edge-First**: All code must be compatible with the Cloudflare Workers runtime (Node.js built-ins may need polyfills).
2. **Type Safety**: strict TypeScript usage, especially for Drizzle schemas and API responses.
3. **Styling**: Use UnoCSS utility classes; avoid raw CSS files except for global resets.
4. **I18n**: Routes are prefaced with `/[lang]/` except for the root landing page which redirects/detects.

## Deploy & Setup
- **Setup**: `npm run setup` (Interactive script to create D1/KV/R2 resources).
- **Dev**: `npm run dev`.
- **Deploy**: `npm run deploy`.
